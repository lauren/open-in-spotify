(function(e){var t={ajaxRequest:function(e,t,n){var r=new XMLHttpRequest;r.onload=e,r.onerror=t,r.open("get",n),r.send()},searchForArtist:function(e,t,n){var r="http://ws.spotify.com/search/1/artist.json?q="+n.replace(/\s/g,"%20");this.ajaxRequest(e,t,r)},searchForTrack:function(e,t,n){var r="http://ws.spotify.com/search/1/track.json?q="+n.replace(/\s/g,"%20");this.ajaxRequest(e,t,r)}};e.spotifyQuerier=t})(typeof exports=="undefined"?this:exports),function(e){var t={htmlEl:document.getElementsByTagName("html")[0]};switch(window.location.hostname){case"songza.com":t.artist=document.getElementsByClassName("szi-artist")[0].innerHTML,t.track=document.getElementsByClassName("szi-song")[0].innerHTML,t.pauseButton=document.getElementsByClassName("szi-pause")[0],t.currentlyPlaying=document.getElementsByClassName("szi-player-state-play").length>0,spotifyQuerier.searchForTrack(function(){router.trackSearch(this.responseText)},render.showError,t.track);break;default:render.showUnsupportedSiteMessage()}e.sourceSiteData=t}(typeof exports=="undefined"?this:exports),function(e){var t={showTrackOptions:function(e){var t=i("large"),r=document.createElement("h2"),s=n();r.innerHTML="Matching Tracks on Spotify",t.appendChild(r),e.map(function(e){var t=document.createElement("li"),n=e.artists[0];t.innerHTML="<a href='"+e.href+"'>"+e.name+"</a> by <a href='"+n.href+"'>"+n.name+"</a> from the album "+"<em><a href='"+e.album.href+"'></em>"+e.album.name+"</a>.",s.appendChild(t)}),t.appendChild(s),o()},showArtistOptions:function(e){var t=i("large"),r=document.createElement("h2"),s=document.createElement("h3"),u=n();s.innerHTML="<p>Sorry! I couldn't find the exact track you're listening to on Spotify.</p>",t.appendChild(s),r.innerHTML="Matching Artists on Spotify",t.appendChild(r),e.map(function(e){var t=document.createElement("li");t.innerHTML="<a href='"+e.href+"'>"+e.name+"</a>",u.appendChild(t)}),t.appendChild(u),o()},showNotFoundMessage:function(){var e=i("small"),t=document.createElement("h2"),n=document.createElement("h3");t.innerHTML="Not Found",e.appendChild(t),n.innerHTML="<p>Sorry, I couldn't find the track '"+sourceSiteData.track+"' or the artist "+sourceSiteData.artist+" on Spotify.</p><p>Try again with the next song you like.</p>",e.appendChild(n)},showUnsupportedSiteMessage:function(){var e=i("small"),t=document.createElement("h2"),n=document.createElement("h3");t.innerHTML="Site Not Supported",e.appendChild(t),n.innerHTML="<p>Sorry, I can't save to spotify from "+window.location.hostname+".</p>"+"<p>Try adding a song from Songza, Pandora, or Turntable.fm.</p>",e.appendChild(n)},showError:function(e){var t=i("small"),n=document.createElement("h2"),r=document.createElement("h3");n.innerHTML="Can't connect to Spotify",t.appendChild(n),r.innerHTML="<p>Sorry, I can't connect to Spotify right now.</p><p>Try again with the next song you like.</p>"+e.target.status,t.appendChild(r)}},n=function(){var e=document.createElement("ul");return e.style.fontSize="20px",e},r=function(){document.body.removeChild(document.getElementById("add-to-spotify-overlay")),document.body.removeChild(document.getElementById("add-to-spotify-modal")),document.body.style.overflow="auto",sourceSiteData.htmlEl.style.overflow="auto",u()},i=function(e){var t=document.body.firstChild,n=document.createElement("div");n.id="add-to-spotify-modal",n.style.margin="auto auto",n.style.background="#fff",n.style.zIndex=1450,n.style.position="fixed",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.overflow="auto",n.style.width=e==="small"?"400px":"70%",n.style.height=e==="small"?"200px":"90%",n.style.borderRadius="5px";var i=document.createElement("div");i.id="close-spotify-modal",i.style.position="absolute",i.style.height="auto",i.style.width="auto",i.style.right="0",i.style.top="0",i.style.fontSize="40px",i.style.lineHeight="25px",i.style.padding="10px",i.style.borderLeft="1px solid #666",i.style.borderBottom="1px solid #666",i.style.borderRight="1px solid #666",i.style.cursor="pointer",i.innerHTML="&times;",n.appendChild(i);var o=document.createElement("div");o.id="add-to-spotify-modal-content",o.style.padding="15px",n.appendChild(o),document.body.insertBefore(n,t),s(i,"click",r);var u=document.createElement("div");return u.id="add-to-spotify-overlay",u.style.background="#000",u.style.opacity=.7,u.style.zIndex=1400,u.style.height=parseInt(window.screen.height+20,10)+"px",u.style.width="100%",u.style.marginTop="-15px",u.style.position="absolute",document.body.style.overflow="hidden",sourceSiteData.htmlEl.style.overflow="hidden",document.body.insertBefore(u,n),o},s=function(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent(t,n)},o=function(){sourceSiteData.currentlyPlaying&&sourceSiteData.pauseButton.click()},u=function(){sourceSiteData.currentlyPlaying&&sourceSiteData.pauseButton.click()};e.render=t}(typeof exports=="undefined"?this:modalExplanation),function(){Array.prototype.map===undefined&&(Array.prototype.map=function(e){var t=[];for(var n=0;n<this.length;n++)t.push(e(this[n]));return t}),Array.prototype.filter===undefined&&(Array.prototype.filter=function(e){var t=[];for(var n=0;n<this.length;n++)e(this[n],n,this)&&t.push(this);return t})}(),function(e){var t=function(e){var t=JSON.parse(e),r=i(t.tracks),o=s(r);o.length===0?spotifyQuerier.searchForArtist(n,render.showError,sourceSiteData.artist):o.length===1?render.openInSpotify(o[0].href):render.showTrackOptions(o)},n=function(e){var t=JSON.parse(this.responseText),n=t.info.num_results;n===0?render.showNotFoundMessage():render.showArtistOptions(t.artists)},r=function(e){window.location=e},i=function(e){return e.filter(function(e){return a(e.artists,sourceSiteData.artist)>-1})},s=function(e){var e=o(e.reverse()),t=e.filter(function(t,n){var r=e.slice(n+1,e.length);return!u(t,r)});return t.reverse()},o=function(e){return e.map(function(e){return e.name=e.name.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,""),e.name=e.name.replace(/\s{2,}/g," "),e.album.name=e.album.name.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,""),e.album.name=e.album.name.replace(/\s{2,}/g," "),e})},u=function(e,t){for(var n=0;n<t.length;n++)if(e.name===t[n].name&&e.album.name===t[n].album.name)return!0;return!1},a=function(e,t){for(var n=0;n<e.length;n++)if(e[n].name.toLowerCase()===t.toLowerCase())return n;return-1};e.router={trackSearch:t,artistSearch:n}}(typeof exports=="undefined"?this:exports);