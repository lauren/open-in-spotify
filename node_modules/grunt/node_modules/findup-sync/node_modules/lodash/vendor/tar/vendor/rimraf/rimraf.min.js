function rimraf(p,cb){if(!cb)throw new Error("No callback passed to rimraf()");var busyTries=0;rimraf_(p,function CB(er){if(er){if(er.code==="EBUSY"&&busyTries<exports.BUSYTRIES_MAX){busyTries++;var time=busyTries*100;return setTimeout(function(){rimraf_(p,CB)},time)}if(er.code==="EMFILE"&&timeout<exports.EMFILE_MAX)return setTimeout(function(){rimraf_(p,CB)},timeout++);er.code==="ENOENT"&&(er=null)}timeout=0,cb(er)})}function rimraf_(p,cb){fs[lstat](p,function(er,s){return er?er.code==="ENOENT"?cb():cb(er):rm_(p,s,!1,cb)})}function writable(s){var mode=s.mode||511,uid=myUid(),gid=myGid();return mode&2||gid===s.gid&&mode&16||uid===s.uid&&mode&128}function rm_(p,s,didWritableCheck,cb){if(!didWritableCheck&&!writable(s))return fs.chmod(p,s.mode|146,function(er){if(er)return cb(er);rm_(p,s,!0,cb)});if(!s.isDirectory())return fs.unlink(p,cb);fs.readdir(p,function(er,files){if(er)return cb(er);asyncForEach(files.map(function(f){return path.join(p,f)}),function(file,cb){rimraf(file,cb)},function(er){if(er)return cb(er);fs.rmdir(p,cb)})})}function asyncForEach(list,fn,cb){list.length||cb();var c=list.length,errState=null;list.forEach(function(item,i,list){fn(item,function(er){if(errState)return;if(er)return cb(errState=er);if(--c===0)return cb()})})}function rimrafSync(p){try{var s=fs[lstatSync](p)}catch(er){if(er.code==="ENOENT")return;throw er}writable(s)||fs.chmodSync(p,s.mode|146);if(!s.isDirectory())return fs.unlinkSync(p);fs.readdirSync(p).forEach(function(f){rimrafSync(path.join(p,f))}),fs.rmdirSync(p)}module.exports=rimraf,rimraf.sync=rimrafSync;var path=require("path"),fs;try{fs=require("../../graceful-fs/graceful-fs.js")}catch(er){fs=require("fs")}var lstat="lstat";if(process.platform==="win32"){var v=process.version.replace(/^v/,"").split(/\.|-/).map(Number);v[0]===0&&(v[1]<7||v[1]==7&&v[2]<9)&&(lstat="stat")}fs[lstat]||(lstat="stat");var lstatSync=lstat+"Sync",timeout=0;exports.EMFILE_MAX=1e3,exports.BUSYTRIES_MAX=3;var myGid=function myGid(){var g=process.getuid&&process.getgid();return myGid=function myGid(){return g},g},myUid=function myUid(){var u=process.getuid&&process.getuid();return myUid=function myUid(){return u},u};