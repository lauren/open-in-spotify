function FileWriter(props){var me=this;if(!(me instanceof FileWriter))throw new Error("FileWriter must be called as constructor.");if(props.type!=="File"||!props.File)throw new Error("Non-file type "+props.type);me._buffer=[],me._bytesWritten=0,Writer.call(this,props)}module.exports=FileWriter;var fs=require("../../graceful-fs/graceful-fs.js"),mkdir=require("../../mkdirp"),Writer=require("./writer.js"),inherits=require("../../inherits/inherits.js"),EOF={};inherits(FileWriter,Writer),FileWriter.prototype._create=function(){var me=this;if(me._stream)return;var so={};me.props.flags&&(so.flags=me.props.flags),so.mode=Writer.filemode,me._old&&me._old.blksize&&(so.bufferSize=me._old.blksize),me._stream=fs.createWriteStream(me._path,so),me._stream.on("open",function(fd){me.ready=!0,me._buffer.forEach(function(c){c===EOF?me._stream.end():me._stream.write(c)}),me.emit("ready"),me.emit("drain")}),me._stream.on("drain",function(){me.emit("drain")}),me._stream.on("close",function(){me._finish()})},FileWriter.prototype.write=function(c){var me=this;me._bytesWritten+=c.length;if(!me.ready){if(!Buffer.isBuffer(c)&&typeof c!="string")throw new Error("invalid write data");return me._buffer.push(c),!1}var ret=me._stream.write(c);return ret||me._stream._queue&&me._stream._queue.length<=2},FileWriter.prototype.end=function(c){var me=this;return c&&me.write(c),me.ready?me._stream.end():(me._buffer.push(EOF),!1)},FileWriter.prototype._finish=function(){var me=this;typeof me.size=="number"&&me._bytesWritten!=me.size&&me.error("Did not get expected byte count.\nexpect: "+me.size+"\n"+"actual: "+me._bytesWritten),Writer.prototype._finish.call(me)};