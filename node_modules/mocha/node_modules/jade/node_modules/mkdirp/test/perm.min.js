var mkdirp=require("../"),path=require("path"),fs=require("fs"),test=require("tap").test;test("async perm",function(t){t.plan(2);var file="/tmp/"+(Math.random()*(1<<30)).toString(16);mkdirp(file,493,function(err){err?t.fail(err):path.exists(file,function(ex){ex?fs.stat(file,function(err,stat){err?t.fail(err):(t.equal(stat.mode&511,493),t.ok(stat.isDirectory(),"target not a directory"),t.end())}):t.fail("file not created")})})}),test("async root perm",function(t){mkdirp("/tmp",493,function(err){err&&t.fail(err),t.end()}),t.end()});