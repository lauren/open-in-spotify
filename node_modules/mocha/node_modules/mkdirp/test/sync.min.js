var mkdirp=require("../"),path=require("path"),fs=require("fs"),test=require("tap").test;test("sync",function(t){t.plan(2);var x=Math.floor(Math.random()*Math.pow(16,4)).toString(16),y=Math.floor(Math.random()*Math.pow(16,4)).toString(16),z=Math.floor(Math.random()*Math.pow(16,4)).toString(16),file="/tmp/"+[x,y,z].join("/");try{mkdirp.sync(file,493)}catch(err){return t.fail(err),t.end()}path.exists(file,function(ex){ex?fs.stat(file,function(err,stat){err?t.fail(err):(t.equal(stat.mode&511,493),t.ok(stat.isDirectory(),"target not a directory"),t.end())}):t.fail("file not created")})});