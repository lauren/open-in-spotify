(function(){var e={htmlEl:document.getElementsByTagName("html")[0]},t=function(){var e=JSON.parse(this.responseText),t=r(e.tracks);t.length===0?s():t.lenght===1?window.location=t[0].href:f(r(t))},n=function(){var n=new XMLHttpRequest;n.onload=t,n.onerror=v,n.open("get","http://ws.spotify.com/search/1/track.json?q="+e.track.replace(/\s/g,"%20")),n.send()};(function(){switch(window.location.hostname){case"songza.com":e.artist=document.getElementsByClassName("szi-artist")[0].innerHTML,e.track=document.getElementsByClassName("szi-song")[0].innerHTML,e.pauseButton=document.getElementsByClassName("szi-pause")[0],e.currentlyPlaying=document.getElementsByClassName("szi-player-state-play").length>0,n();break;default:showUnsupportedSiteMessage()}})();var r=function(t){return tracksWithArtist=t.filter(function(t){return i(t.artists,e.artist)>-1})},i=function(e,t){for(var n=0;n<e.length;n++)if(e[n].name.toLowerCase()===t.toLowerCase())return n;return-1},s=function(){var t=new XMLHttpRequest;t.onload=o,t.onerror=v,t.open("get","http://ws.spotify.com/search/1/artist.json?q="+e.artist.replace(/\s/g,"%20")),t.send()},o=function(){var e=JSON.parse(this.responseText),t=e.info.num_results;t===0?u():a(e.artists)},u=function(){var t=p("small"),n=document.createElement("h2"),r=document.createElement("h3");n.innerHTML="Not Found",t.appendChild(n),r.innerHTML="<p>Sorry, I couldn't find the track '"+e.track+"' or the artist "+e.artist+" on Spotify.</p><p>Try again with the next song you like.</p>",t.appendChild(r)},a=function(e){var t=p("large"),n=document.createElement("h2"),r=document.createElement("h3"),i=h();r.innerHTML="<p>Sorry! I couldn't find the exact track you're listening to on Spotify.</p>",t.appendChild(r),n.innerHTML="Matching Artists on Spotify",t.appendChild(n),e.map(function(e){var t=document.createElement("li");t.innerHTML="<a href='"+e.href+"'>"+e.name+"</a>",i.appendChild(t)}),t.appendChild(i),l()},f=function(e){var t=p("large"),n=document.createElement("h2"),r=h();n.innerHTML="Matching Tracks on Spotify",t.appendChild(n),e.map(function(e){var t=document.createElement("li"),n=e.artists[0];t.innerHTML="<a href='"+e.href+"'>"+e.name+"</a> by <a href='"+n.href+"'>"+n.name+"</a> from the album "+"<em><a href='"+e.album.href+"'></em>"+e.album.name+"</a>.",r.appendChild(t)}),t.appendChild(r),l()},l=function(){e.currentlyPlaying&&e.pauseButton.click()},c=function(){e.currentlyPlaying&&e.pauseButton.click()},h=function(){var e=document.createElement("ul");return e.style.fontSize="20px",e},p=function(t){var n=document.body.firstChild,r=document.createElement("div");r.id="add-to-spotify-modal",r.style.margin="auto auto",r.style.background="#fff",r.style.zIndex=1450,r.style.position="fixed",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.overflow="auto",r.style.width=t==="small"?"400px":"70%",r.style.height=t==="small"?"200px":"90%",r.style.borderRadius="5px";var i=document.createElement("div");i.id="close-spotify-modal",i.style.position="absolute",i.style.height="auto",i.style.width="auto",i.style.right="0",i.style.top="0",i.style.fontSize="40px",i.style.lineHeight="25px",i.style.padding="10px",i.style.borderLeft="1px solid #666",i.style.borderBottom="1px solid #666",i.style.borderRight="1px solid #666",i.style.cursor="pointer",i.innerHTML="&times;",r.appendChild(i);var s=document.createElement("div");s.id="add-to-spotify-modal-content",s.style.padding="15px",r.appendChild(s),document.body.insertBefore(r,n),m(i,"click",d);var o=document.createElement("div");return o.id="add-to-spotify-overlay",o.style.background="#000",o.style.opacity=.7,o.style.zIndex=1400,o.style.height=parseInt(window.screen.height+20,10)+"px",o.style.width="100%",o.style.marginTop="-15px",o.style.position="absolute",document.body.style.overflow="hidden",e.htmlEl.style.overflow="hidden",document.body.insertBefore(o,r),s},d=function(){document.body.removeChild(document.getElementById("add-to-spotify-overlay")),document.body.removeChild(document.getElementById("add-to-spotify-modal")),document.body.style.overflow="auto",e.htmlEl.style.overflow="auto",c()},v=function(e){var t=p("small"),n=document.createElement("h2"),r=document.createElement("h3");n.innerHTML="Can't connect to Spotify",t.appendChild(n),r.innerHTML="<p>Sorry, I can't connect to Spotify right now.</p><p>Try again with the next song you like.</p>"+e.target.status,t.appendChild(r)},m=function(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent(t,n)};Array.prototype.map===undefined&&(Array.prototype.map=function(e){var t=[];for(var n=0;n<this.length;n++)t.push(e(this[n]));return t}),Array.prototype.filter===undefined&&(Array.prototype.filter=function(e){var t=[];for(var n=0;n<this.length;n++)e(this[n])&&t.push(this);return t})})();