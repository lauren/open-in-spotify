(function(){var e=document.getElementsByClassName("szi-artist")[0].innerHTML,t=document.getElementsByClassName("szi-song")[0].innerHTML,n=document.getElementsByClassName("szi-pause")[0],r=document.getElementsByTagName("html")[0],i=function(){var e=JSON.parse(this.responseText),t=s(e.tracks);t.length===0?u():t.length===1?window.location=t[0].href:c(s(t))};(function(){var e=new XMLHttpRequest;e.onload=i,e.open("get","http://ws.spotify.com/search/1/track.json?q="+t.replace(/\s/g,"%20")),e.send()})();var s=function(t){return tracksWithArtist=t.filter(function(t){return o(t.artists,e)>-1})},o=function(e,t){for(var n=0;n<e.length;n++)if(e[n].name.toLowerCase()===t.toLowerCase())return n;return-1},u=function(){var t=new XMLHttpRequest;t.onload=a,t.open("get","http://ws.spotify.com/search/1/artist.json?q="+e.replace(/\s/g,"%20")),t.send()},a=function(){var e=JSON.parse(this.responseText),t=e.info.num_results;t===0?f():l(e.artists)},f=function(){var n=v("small"),r=document.createElement("h2"),i=document.createElement("h3");r.innerHTML="Not Found",n.appendChild(r),i.innerHTML="<p>Sorry, I couldn't find the track '"+t+"' or the artist "+e+" on Spotify.</p><p>Try again with the next song you like.</p>",n.appendChild(i)},l=function(e){var t=v("large"),n=document.createElement("h2"),r=document.createElement("h3"),i=d();r.innerHTML="<p>Sorry! I couldn't find the exact track you're listening to on Spotify.</p>",t.appendChild(r),n.innerHTML="Matching Artists on Spotify",t.appendChild(n),e.map(function(e){var t=document.createElement("li");t.innerHTML="<a href='"+e.href+"'>"+e.name+"</a>",i.appendChild(t)}),t.appendChild(i),h()},c=function(e){var t=v("large"),n=document.createElement("h2"),r=d();n.innerHTML="Matching Tracks on Spotify",t.appendChild(n),console.log(e),console.log(r),e.map(function(e){var t=document.createElement("li"),n=e.artists[0];t.innerHTML="<a href='"+e.href+"'>"+e.name+"</a> by <a href='"+n.href+"'>"+n.name+"</a> from the album "+"<em><a href='"+e.album.href+"'></em>"+e.album.name+"</a>.",r.appendChild(t)}),t.appendChild(r),h()},h=function(){document.getElementsByClassName("szi-player-state-play").length>0&&n.click()},p=function(){document.getElementsByClassName("szi-player-state-pause").length>0&&n.click()},d=function(){var e=document.createElement("ul");return e.style.fontSize="20px",e},v=function(e){var t=document.body.firstChild,n=document.createElement("div");n.id="add-to-spotify-modal",n.style.margin="auto auto",n.style.background="#fff",n.style.zIndex=1450,n.style.position="fixed",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.overflow="auto",n.style.width=e==="small"?"400px":"70%",n.style.height=e==="small"?"200px":"90%",n.style.borderRadius="5px";var i=document.createElement("div");i.id="close-spotify-modal",i.style.position="absolute",i.style.height="auto",i.style.width="auto",i.style.right="0",i.style.top="0",i.style.fontSize="40px",i.style.lineHeight="25px",i.style.padding="10px",i.style.borderLeft="1px solid #666",i.style.borderBottom="1px solid #666",i.style.borderRight="1px solid #666",i.style.cursor="pointer",i.innerHTML="&times;",n.appendChild(i);var s=document.createElement("div");s.id="add-to-spotify-modal-content",s.style.padding="10px 15px",n.appendChild(s),document.body.insertBefore(n,t),g(i,"click",m);var o=document.createElement("div");return o.id="add-to-spotify-overlay",o.style.background="#000",o.style.opacity=.7,o.style.zIndex=1400,o.style.height=parseInt(window.screen.height+20,10)+"px",o.style.width="100%",o.style.marginTop="-15px",o.style.position="absolute",document.body.style.overflow="hidden",r.style.overflow="hidden",document.body.insertBefore(o,n),s},m=function(){document.body.removeChild(document.getElementById("add-to-spotify-overlay")),document.body.removeChild(document.getElementById("add-to-spotify-modal")),document.body.style.overflow="auto",r.style.overflow="auto",p()},g=function(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent(t,n)};Array.prototype.map===undefined&&(Array.prototype.map=function(e){var t=[];for(var n=0;n<this.length;n++)t.push(e(this[n]));return t}),Array.prototype.filter===undefined&&(Array.prototype.filter=function(e){var t=[];for(var n=0;n<this.length;n++)e(this[n])&&t.push(this);return t})})();